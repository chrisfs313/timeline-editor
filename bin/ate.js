function ATE_Resources(){}function ATE_Styles(){}function ATE_Button(e){var t=e;this.ctx=t.ctx,this.Initialize=function(){},this.Update=function(e){}}function ATE_HtmlButton(e){var t=this,i=e;this.ctx=i.ctx;var n,a,s,r,o=!1;this.GetButtonSelector=function(){return s},this.Initialize=function(e,i){n=e,a=i,(s=$("<img src='"+n+"' width='20' />")).on("click",t.OnClick)},this.Reset=function(){o=!1,s.attr("src",n)},this.SetClickCallback=function(e){r=e},this.AddMargin=function(){s.css("margin-left","4px")},this.OnClick=function(e){o=!o,a&&s.attr("src",o?a:n),r&&r(e)},this.Update=function(e){}}function ATE_Util(){}function ATE_Engine(){var e,t,i,n,a,s,r,o,l=this,c=0,u=0,T=0,y=0,f=0;this.ctx=void 0;var E,h,_,d,S,m,A,g,p,v,C,b=ATE_Styles.Default_SubSegments,I=[],G=[];this.GetCanvasContext=function(){return mCanvasContext},this.GetAnimationSeconds=function(){return E},this.GetSubSegments=function(){return b},this.GetParentSelector=function(){return t},this.GetParentGUISelector=function(){return n},this.GetControlsUI_Selector=function(){return r},this.GetLayersUI_Selector=function(){return o},this.GetInputCurrentTimeSelector=function(){return s},this.GetWidth=function(){return c},this.GetHeight=function(){return u},this.GetScrollX=function(){return y},this.GetScrollY=function(){return f},this.GetGUI_RealSegmentWidth=function(){return _},this.GetGUI_RealSubSegmentWidth=function(){return d},this.GetLayers=function(){return G},this.GetSegments=function(){return I},this.GetPlaybackController=function(){return h},this.GetCurrentFocusSegment=function(){return-1},this.Initialize=function(i){e=i,(t=$(e)).css("height","100%"),c=t.width(),u=ATE_Styles.GUIHeight,T=u-ATE_Styles.ScrollbarHeight;var n=$("<img id='"+ATE_Resources.Diamond.Id+"' src='"+ATE_Resources.Diamond.Path+"' />");n.css("display","none");var a=$("<img id='"+ATE_Resources.DiamondSelected.Id+"' src='"+ATE_Resources.DiamondSelected.Path+"' />");a.css("display","none"),t.append(n),t.append(a),l.CreateGUI(),l.CreateMouseEvents(),l.ChangeAnimationSeconds(ATE_Styles.Default_Seconds),(h=new ATE_Playback(l)).Initialize(),h.ConfigureFPS(60)},this.InvalidateLayers=function(){for(var e=0;e<G.length;e++)G[e].Invalidate()},this.CreateMouseEvents=function(){function e(e,t){var i=e.getBoundingClientRect();return{x:t.clientX-i.left,y:t.clientY-i.top}}mParentCanvasSelector.on("mousemove",function(t){var i=e(mParentCanvasSelector[0],t);h.OnMouseMove(i)}),mParentCanvasSelector.on("mouseup",function(t){var i=e(mParentCanvasSelector[0],t);h.OnMouseUp(i)}),mParentCanvasSelector.on("mousedown",function(t){var i=e(mParentCanvasSelector[0],t);h.OnMouseDown(i)}),mParentCanvasSelector.on("click",function(e){}),mParentCanvasSelector.on("dblclick",function(e){}),mParentCanvasSelector.on("mouseout",function(t){var i=e(mParentCanvasSelector[0],t);h.OnMouseOut(i)})},this.CreateGUI=function(){a="gui-"+e.substring(1),(n=$("<div id='"+a+"'></div>")).css("width",ATE_Styles.AC_Width+"px"),n.css("height",u+"px"),n.css("float","left"),n.css("background-color",ATE_Styles.BackgroundColor),t.append(n),i="canvas-"+e.substring(1),mParentCanvasSelector=$("<canvas id='"+i+"' width='"+(c-ATE_Styles.AC_Width)+"' height='"+T+"'></canvas>"),mParentCanvasSelector.css("float","left"),t.append(mParentCanvasSelector),v=$("<div style='height:"+T+"px;width:"+ATE_Styles.ScrollbarHeight+"px;float: right;overflow-y: auto;'></div>"),C=$("<div style='height:"+T+"px'></div>"),v.append(C),t.append(v),g=$("<div style='height:"+(u-T)+"px;width: 0px;float: left;overflow-X: auto;'></div>"),p=$("<div style='width:0px;height:1px'></div>"),g.append(p),t.append(g),l.ctx=mParentCanvasSelector[0].getContext("2d"),function(){var e=$("<hr style='border-color:"+ATE_Styles.CStroke_Color+";border-width: 0.5px;margin: 0;padding: 0;-webkit-margin-before: 0;-webkit-margin-after: 0;-webkit-margin-start: 0;-webkit-margin-end: 0;transform: translateY(1px);' />");(r=$("<div><div>")).css("height",ATE_Styles.AC_TimelineHeight-1);var t=$("<div><div>");t.css("padding-top","4px"),t.css("padding-left","4px"),r.append(t),(m=new ATE_HtmlButton(l)).Initialize("res/spRecord.png","res/spStopRecording.png"),(S=new ATE_HtmlButton(l)).Initialize("res/spPlay.png","res/spPause.png"),S.AddMargin(),S.SetClickCallback(function(){h.PlayOrPause()}),(A=new ATE_HtmlButton(l)).Initialize("res/spStop.png"),A.AddMargin(),A.SetClickCallback(function(){S.Reset(),h.Stop()});var i=$("<label style='font-size:12px;color:white;margin-left:5px'>Time:<label/>");s=$("<input type='text' value='0.00' />");var a=$("<input type='text' value='"+ATE_Util.GetDigitsByValue(ATE_Styles.Default_Seconds,2)+".00'/>");a.on("change",function(){var e=Math.floor(parseFloat($(this).val()));e=ATE_Util.GetDigitsByValue(e,2),$(this).val(e+".00"),l.ChangeAnimationSeconds(parseInt(e))}),ATE_Engine.SetStylesInput_Time(s,!0),ATE_Engine.SetStylesInput_Time(a),t.append(m.GetButtonSelector()),t.append(S.GetButtonSelector()),t.append(A.GetButtonSelector()),t.append(i),t.append(s),t.append($("<label style='color:white'>/<label/>")),t.append(a),n.append(r),n.append(e)}(),(o=$("<div><div>")).css("height",T-ATE_Styles.AC_TimelineHeight-1+"px"),o.css("overflow-y","hidden"),n.append(o),o.append($("<div style='height:"+ATE_Styles.Timeline.OffsetY+"px'></div>"))},this.ChangeAnimationSeconds=function(e){E=e,l.CreateSegments(E)},this.GetLayer=function(e){for(var t={Exists:!1,Layer:void 0},i=0;i<G.length;i++)if(G[i].GetLayerName()===e){t.Exists=!0,t.Layer=G[i];break}return t},this.AddLayer=function(e,t,i){var n={Layer:void 0,Keyframe:void 0},a=l.GetLayer(e);if(a.Exists)n.Layer=a.Layer,n.Keyframe=a.Layer.SetKeyframe(t,i);else{var s=new ATE_Layer(l);s.Initialize(e),n.Layer=s,n.Keyframe=s.SetKeyframe(t,i),G.push(s)}return n},this.CreateSegments=function(e){function t(t,i){for(var n=t=void 0===t?0:t;n<i;n++){var a=new ATE_Segment(l);a.Initialize(n),a.FirstSegment=0===n,a.LastSegment=n===e-1,I.push(a)}}if(0===I.length)t(0,e);else{var i=e-I.length;if(i>0)t(I.length,e);else{for(var n=I.length,a=n-1;a>=n+i;a--)I[a].Destroy();I.splice(n+i,Math.abs(i));for(a=0;a<G.length;a++)G[a].RemoveKeyframesBetween(e+ATE_Engine.EPSILON,Number.MAX_VALUE)}}},this.DrawGUI=function(e){var t=l.ctx;t.clearRect(0,0,c,u),t.fillStyle=ATE_Styles.BackgroundColor,t.fillRect(0,0,c,u),t.translate(.5,.5),t.beginPath(),t.moveTo(0,0),t.lineTo(0,T),t.lineWidth=1,t.strokeStyle=ATE_Styles.CStroke_Color,t.stroke(),t.closePath(),t.beginPath(),t.moveTo(0,ATE_Styles.AC_TimelineHeight+ATE_Styles.Timeline.OffsetY),t.lineTo(c,ATE_Styles.AC_TimelineHeight+ATE_Styles.Timeline.OffsetY),t.lineWidth=1,t.strokeStyle=ATE_Styles.CStroke_Color,t.stroke(),t.closePath()},this.DrawSegments=function(e){var t=l.ctx,i=l.GetGUI_RealSegmentWidth()*E+ATE_Styles.Timeline.OffsetX,n=ATE_Styles.AC_TimelineHeight;t.fillStyle=ATE_Styles.BackgroundColor,t.fillRect(0,0,i,n);for(var a=0;a<E;a++)I[a].Update(e)},this.DrawLayers=function(e){for(var t=0;t<G.length;t++)G[t].Update(t,e)},this.DrawLayersGUI=function(e){for(var t=0;t<G.length;t++)G[t].DrawGUI(t,e)},this.ComputeVariables=function(){d=ATE_Styles.AC_TimelineSegmentWidth/(b+1);var e=(_=ATE_Styles.AC_TimelineSegmentWidth-d)*E+ATE_Styles.AC_TimelineHeight;g.css("width",c-ATE_Styles.AC_Width),p.css("width",e),y=-g[0].scrollLeft;var t=(G.length+2)*ATE_Styles.AC_TimelineLayerHeight;C.css("height",t),f=-v[0].scrollTop,o[0].scrollTop=-f,mParentCanvasSelector.attr("width",c-ATE_Styles.AC_Width-20),mParentCanvasSelector.attr("height",T),n.css("height",u+"px"),v.css("height",T+"px"),g.css("height",u-T+"px"),o.css("height",T-ATE_Styles.AC_TimelineHeight-1+"px")},this.Update=function(e){c=t.width(),T=u-ATE_Styles.ScrollbarHeight,l.ComputeVariables(),l.DrawGUI(e),l.DrawLayersGUI(e),l.DrawLayers(e),l.DrawSegments(e),m.Update(e),S.Update(e),A.Update(e),h.Update(e)}}function ATE_Layer(e){var t=this,i=e,n=$("#"+ATE_Resources.Diamond.Id)[0],a=$("#"+ATE_Resources.DiamondSelected.Id)[0];this.ctx=i.ctx;var s,r,o,l,c,u,T,y=[],f=ATE_Resources.Diamond.TimelineWidth,E=ATE_Resources.Diamond.TimelineHeight,h=.5*-f,_=.5*ATE_Styles.AC_TimelineLayerHeight+.5*-f;this.GetLayerName=function(){return s},this.Initialize=function(e){s=e;var t=i.GetLayersUI_Selector();(o=$("<div data-layer-name='"+e+"'></div>")).css("height",ATE_Styles.AC_TimelineLayerHeight);var n=$("<div></div>");n.css("height",ATE_Styles.AC_TimelineLayerHeight),l=$("<div style='float:left;'>"+s+"</div>");var a=$("<div style='float:right;padding-top: 5px;'></div>");c=$("<input type='text'></input>"),u=ATE_Layer.CreateTweenSelect(ATE_Layer.TweenType),T=ATE_Layer.CreateKeyframeAddButton(),a.append(u),a.append(T),a.append(c),ATE_Layer.SetLabelCSS_LayerName(l),ATE_Layer.SetLabelCSS_LayerValue(c),n.append(l),n.append(a),o.append(n),o.append(ATE_Layer.CreateHR()),t.append(o)},this.OnPlayOrPause=function(e){e&&(c.off(),u.off(),T.off(),c.css("display","block"),c.attr("disabled",!0),u.css("display","none"),T.css("display","none"))},this.OnStop=function(){t.Invalidate()},this.Invalidate=function(){t.UpdateFromPlayback(i.GetPlaybackController().GetCurrentTime(),33,!0)},this.OnMouseClick_Keyframe=function(e){i.GetPlaybackController().GetIsPlaying()||c.val(e.Value.toFixed(3))},this.GetKeyframeByPosition=function(e,t){for(var n=void 0,a=ATE_Styles.AC_TimelineLayerHeight,s=i.GetGUI_RealSegmentWidth(),o=.5*a+0,l=0;l<y.length;l++){var c=y[l];if(c){var u=c.Time*s+0+ATE_Styles.Timeline.OffsetX,T=r*a+ATE_Styles.AC_TimelineHeight+o+ATE_Styles.Timeline.OffsetY;if(ATE_Util.HitTestCenterByPoint(u,T,f,E,e,t)){n=c;break}}}return n},this.GetKeyframeByTime=function(e){for(var t=void 0,n=(ATE_Styles.AC_TimelineLayerHeight,i.GetGUI_RealSegmentWidth(),0);n<y.length;n++){var a=y[n];if(a&&a.Time>=e-ATE_Engine.EPSILON&&a.Time<=e+ATE_Engine.EPSILON){t=a;break}}return t},this.SetKeyframe=function(e,t){var i={Name:s,Time:e,DataType:ATE_Layer.DataTypes.Numeric,Value:t,TweenType:ATE_Layer.TweenType.None,__Img:n,__ImgSelected:a,__Selected:!1};return y.push(i),y.sort(function(e,t){return e.Time-t.Time}),i},this.RemoveKeyframe=function(e){for(var t=0;t<y.length;t++){var i=y[t];if(i&&i.Time===e){y.splice(t,1);break}}y.sort(function(e,t){return e.Time-t.Time})},this.RemoveKeyframesBetween=function(e,t){for(var i=0;i<y.length;i++){var n=y[i];n&&n.Time>=e&&n.Time<=t&&(y.splice(i,1),i--)}},this.GetKeyframesBetween=function(e){var t={KFi:void 0,KFe:void 0,NoData:!0,KFi_IsFirst:!1,KFe_IsLast:!1},i=y.length;if(i>1)for(var n=0;n<i;n++){var a=y[n],s=y[n+1];if(a.Time<=e){if(s&&s.Time>=e){t.KFi=a,t.KFe=s,t.NoData=!1,t.KFi_IsFirst=0===n,t.KFe_IsLast=n+1===i-1;break}void 0===s&&(t.KFe_IsLast=!0,t.KFi=a,t.NoData=!1)}}else 1===i&&(t.KFi=y[0],t.NoData=!1,t.KFi_IsFirst=!0);return t},this.GetKeyFrameRenderData=function(e){var t=ATE_Styles.AC_TimelineLayerHeight,n=i.GetGUI_RealSegmentWidth(),a=e.Time*n+h+ATE_Styles.Timeline.OffsetX,s=r*t+ATE_Styles.AC_TimelineHeight+_+ATE_Styles.Timeline.OffsetY,o=e.__Selected?e.__ImgSelected:e.__Img;return{X:a,Y:s,Width:f,Height:E,Img:o,Keyframe:e}},this.Update=function(e,i){t.ctx;for(var n=0;n<y.length;n++){var a=y[n],s=y[n+1];a&&t.DrawKeyframe(a,s,e,i)}},this.ShowEditControls=function(e){if(!i.GetPlaybackController().GetIsPlaying()){var n=i.GetPlaybackController().GetCurrentTime(),a=t.GetKeyframeByTime(n);switch(e){case ATE_Layer.EditControls.Value_Editable:c.css("display","block"),c.removeAttr("disabled"),c.off().on("change paste keyup",m),u.css("display","none"),u.off(),T.css("display","none"),T.off();break;case ATE_Layer.EditControls.Keyframe:c.css("display","none"),c.attr("disabled","true"),c.off(),u.css("display","none"),u.off(),T.css("display","block"),T.off().on("click",d);break;case ATE_Layer.EditControls.Tween:c.css("display","block"),c.removeAttr("disabled"),c.off().on("change paste keyup",m),u.val(a.TweenType),u.css("display","block"),u.off().on("change",A),T.css("display","block"),T.off().on("click",S)}}};var d=function(e){var n=i.GetPlaybackController().GetCurrentTime(),a=i.AddLayer(s,n,0);t.OnMouseClick_Keyframe(a.Keyframe),t.Invalidate()},S=function(e){var n=i.GetPlaybackController().GetCurrentTime();t.RemoveKeyframe(n),t.Invalidate()},m=function(e){if(!i.GetPlaybackController().GetIsPlaying()){var n=i.GetPlaybackController().GetCurrentTime(),a=t.GetKeyframeByTime(n);if(a){var s=$(this).val();switch(a.DataType){case ATE_Layer.DataTypes.Numeric:a.Value=parseFloat(s)}}}},A=function(e){var n=parseInt($(this).val()),a=i.GetPlaybackController().GetCurrentTime(),s=t.GetKeyframeByTime(a);s&&(s.TweenType=n)};this.UpdateFromPlayback=function(e,i,n){n=void 0!==n&&n;var a=t.GetKeyframeByTime(e),s=t.GetKeyframesBetween(e);if(s.NoData)t.ShowEditControls(ATE_Layer.EditControls.Keyframe),T.attr("src",ATE_Resources.Diamond.Path);else{if(n){if(a){var r=s.KFi&&s.KFe,o=r&&s.KFe.Time===e&&s.KFe_IsLast;r=r&&!o,t.ShowEditControls(r?ATE_Layer.EditControls.Tween:ATE_Layer.EditControls.Value_Editable)}else t.ShowEditControls(ATE_Layer.EditControls.Keyframe);T.attr("src",a?ATE_Resources.DiamondSelected.Path:ATE_Resources.Diamond.Path)}var l=s.KFi.Value,u=a?a.Value:l;if(s.KFe){var y=s.KFi.Time,f=s.KFe.Time,E=s.KFe.Value,h=1-(f-e)/(f-y),_=void 0;switch(s.KFi.TweenType){case ATE_Layer.TweenType.EaseLinear:_=Easing.Equations.easeLinear;break;case ATE_Layer.TweenType.EaseInQuad:_=Easing.Equations.easeInQuad;break;case ATE_Layer.TweenType.EaseOutQuad:_=Easing.Equations.easeOutQuad;break;case ATE_Layer.TweenType.EaseInOutQuad:_=Easing.Equations.easeInOutQuad;break;case ATE_Layer.TweenType.EaseInCubic:_=Easing.Equations.easeInCubic;break;case ATE_Layer.TweenType.EaseOutCubic:_=Easing.Equations.easeOutCubic;break;case ATE_Layer.TweenType.EaseInOutCubic:_=Easing.Equations.easeInOutCubic;break;case ATE_Layer.TweenType.EaseInSine:_=Easing.Equations.easeInSine;break;case ATE_Layer.TweenType.EaseOutSine:_=Easing.Equations.easeOutSine;break;case ATE_Layer.TweenType.EaseInOutSine:_=Easing.Equations.easeInOutSine;break;case ATE_Layer.TweenType.EaseInExpo:_=Easing.Equations.easeInExpo;break;case ATE_Layer.TweenType.EaseOutExpo:_=Easing.Equations.easeOutExpo;break;case ATE_Layer.TweenType.EaseInOutExpo:_=Easing.Equations.easeInOutExpo;break;case ATE_Layer.TweenType.EaseInElastic:_=Easing.Equations.easeInElastic;break;case ATE_Layer.TweenType.EaseOutElastic:_=Easing.Equations.easeOutElastic;break;case ATE_Layer.TweenType.EaseInOutElastic:_=Easing.Equations.easeInOutElastic}_&&(u=_(h,l,E-l,1))}c.val(u.toFixed(3))}},this.DrawGUI=function(e,n){var a=t.ctx,s=ATE_Styles.AC_TimelineLayerHeight,r=i.GetScrollX(),o=i.GetScrollY()+(e+1)*s+ATE_Styles.AC_TimelineHeight+ATE_Styles.Timeline.OffsetY,l=i.GetAnimationSeconds()*i.GetGUI_RealSegmentWidth()+ATE_Styles.Timeline.OffsetX;a.beginPath(),a.moveTo(r,o),a.lineTo(l,o),a.lineWidth=1,a.lineHeight=1,a.strokeStyle=ATE_Styles.CStroke_Color,a.stroke(),a.closePath()},this.DrawKeyframe=function(e,n,a,s){r=a;var o=t.ctx,l=i.GetScrollX(),c=i.GetScrollY(),u=t.GetKeyFrameRenderData(e);if(n)switch(e.TweenType){case ATE_Layer.TweenType.EaseLinear:case ATE_Layer.TweenType.EaseInQuad:case ATE_Layer.TweenType.EaseOutQuad:case ATE_Layer.TweenType.EaseInOutQuad:case ATE_Layer.TweenType.EaseInCubic:case ATE_Layer.TweenType.EaseOutCubic:case ATE_Layer.TweenType.EaseInOutCubic:case ATE_Layer.TweenType.EaseInSine:case ATE_Layer.TweenType.EaseOutSine:case ATE_Layer.TweenType.EaseInOutSine:case ATE_Layer.TweenType.EaseInExpo:case ATE_Layer.TweenType.EaseOutExpo:case ATE_Layer.TweenType.EaseInOutExpo:case ATE_Layer.TweenType.EaseInElastic:case ATE_Layer.TweenType.EaseOutElastic:case ATE_Layer.TweenType.EaseInOutElastic:var T=t.GetKeyFrameRenderData(n),y=u.X+.5*ATE_Resources.Diamond.TimelineWidth+l,f=u.Y-_+c,E=T.X-u.X,h=ATE_Styles.AC_TimelineLayerHeight;o.beginPath(),o.fillStyle="#0000FF55",o.fillRect(y,f,E,h),o.closePath()}o.drawImage(u.Img,u.X+l,u.Y+c,u.Width,u.Height)},this.Destroy=function(){i.GetLayersUI_Selector().remove(o),y=void 0,t.ctx=void 0,i=void 0,t=void 0,o=void 0,l=void 0,c=void 0,u=void 0,T=void 0,n=void 0,a=void 0}}function ATE_Playback(e){var t=this,i=e;this.ctx=i.ctx;var n=!1,a=0,s=1/ATE_Styles.Playback.DefaultTime,r=i.GetInputCurrentTimeSelector(),o=!1,l=!1;this.GetIsPlaying=function(){return n},this.GetCurrentTime=function(){return a},this.Initialize=function(){},this.ConfigureFPS=function(e){var t=1e3/e;s=1/ATE_Styles.Playback.DefaultTime/t},this.OnMouseOut=function(e){n||(o=!1)},this.OnMouseMove=function(e){l=e},this.OnMouseUp=function(e){n||(o=!1)},this.OnMouseDown=function(e){if(!n){i.GetScrollX();var t=ATE_Styles.Timeline.OffsetX,a=i.GetAnimationSeconds(),s=t,r=i.GetGUI_RealSegmentWidth()*a,l=i.GetHeight()+ATE_Styles.AC_TimelineHeight;ATE_Util.HitTestByPoint(s,0,r,l,e.x,e.y)&&(o=!0)}},this.PlayOrPause=function(){n=!n;for(var e=i.GetLayers(),t=0;t<e.length;t++)e[t].OnPlayOrPause(n)},this.Stop=function(){n=!1,a=0;for(var e=i.GetLayers(),t=0;t<e.length;t++)e[t].OnStop()},this.Update=function(e){var r=i.GetAnimationSeconds();if(n)a=a>=r?0:(a=(a+=s*e)<0?0:a)>r?r:a;else if(o){var c=i.GetScrollX(),u=ATE_Engine.GetSegment(i,l.x-c,l.y)/ATE_Styles.Default_SubSegments;a!==u&&(a=(a=(a=u)<0?0:a)>r?r:a)}var T=i.GetLayers(),y=!n&&o;if(n||o)for(var f=0;f<T.length;f++)T[f].UpdateFromPlayback(a,e,y);t.Draw(e)},this.Draw=function(e){var n=t.ctx,s=i.GetScrollX(),o=i.GetGUI_RealSegmentWidth(),l=i.GetGUI_RealSubSegmentWidth(),c=ATE_Styles.Timeline.OffsetX+a*o-l-ATE_Styles.Playback.GUI_Width/4+1+s,u=ATE_Styles.Timeline.OffsetY,T=c+.5*ATE_Styles.Playback.GUI_Width+1;n.beginPath(),n.fillStyle=ATE_Styles.Playback.GUI_BackgroundColor,n.fillRect(c+ATE_Styles.Playback.GUI_TextTimeOffset.X,u,ATE_Styles.Playback.GUI_Width,ATE_Styles.Playback.GUI_Height),n.closePath(),n.beginPath(),n.moveTo(T,u),n.lineTo(T,i.GetHeight()),n.lineWidth=1,n.strokeStyle=ATE_Styles.Playback.GUI_LineColor,n.stroke(),n.closePath(),n.font=ATE_Styles.Playback.GUI_TextStyle,n.fillStyle=ATE_Styles.Playback.GUI_TextColor,n.textAlign="center",n.fillText(ATE_Util.FormatTime(1e3*(a+ATE_Engine.EPSILON),2,!0),T,u+ATE_Styles.Playback.GUI_Height+ATE_Styles.Playback.GUI_TextTimeOffset.Y),r.val(ATE_Util.FormatTimeAsSeconds(1e3*(a+ATE_Engine.EPSILON)))}}function ATE_Segment(e){var t=this,i=e;this.ctx=i.ctx,this.FirstSegment=!1,this.LastSegment=!1;var n=0,a="",s="";this.Initialize=function(e){n=e,a=ATE_Util.FormatTime(1e3*n,2),s=ATE_Util.FormatTime(1e3*(n+1),2)},this.Update=function(e){t.Draw(e)},this.Draw=function(e){for(var r=t.ctx,o=ATE_Styles.AC_TimelineSegmentWidth,l=i.GetSubSegments()+1,c=o/l,u=i.GetScrollX(),T=n*o-(0!==n?c*n:0),y=ATE_Styles.AC_TimelineHeight,f=0;f<l;f++){var E=Math.round(T+f*c)+ATE_Styles.Timeline.OffsetX+u,h=Math.round(y)+ATE_Styles.Timeline.OffsetY,_=0===f||f===l-1,d=_?ATE_Styles.AC_TimelineSubSegmentLimitsHeight:ATE_Styles.AC_TimelineSubSegmentHeight,S=0===f||f===l-1&&t.LastSegment;if(r.beginPath(),r.moveTo(E,h),r.lineTo(E,h-d),r.lineWidth=1,r.strokeStyle=ATE_Styles.AC_TimelineSubSegment_Color,r.stroke(),r.closePath(),r.beginPath(),r.moveTo(E,h),r.lineTo(E,i.GetHeight()-ATE_Styles.ScrollbarHeight),r.lineWidth=1,r.strokeStyle=_?ATE_Styles.AC_TimelineSubSegment_Color:ATE_Styles.CStroke_Color,r.stroke(),r.closePath(),S){var m=f===l-1&&t.LastSegment?s:a;r.font=ATE_Styles.AC_TimelineSubSegment_TextStyle,r.fillStyle=ATE_Styles.Font_Color,r.textAlign="center",r.fillText(m,E,h-ATE_Styles.AC_TimelineSubSegmentLimitsHeight-10)}}},this.Destroy=function(){t.ctx=void 0,t=void 0,i=void 0}}function Easing(){}ATE_Resources.Diamond={Id:"ate-img-diamond",Path:"res/spATE_diamond.png",TimelineWidth:10,TimelineHeight:10},ATE_Resources.DiamondSelected={Id:"ate-img-diamond-selected",Path:"res/spATE_diamond_selected.png",TimelineWidth:10,TimelineHeight:10},ATE_Styles.Default_Seconds=10,ATE_Styles.Default_SubSegments=10,ATE_Styles.ScrollbarHeight=16,ATE_Styles.GUIHeight=140,ATE_Styles.CanvasHeight=ATE_Styles.GUIHeight-ATE_Styles.ScrollbarHeight,ATE_Styles.BackgroundColor="#4e4e4e",ATE_Styles.CStroke_Color="#6e6e6e",ATE_Styles.Font_Color="#f9f9f9",ATE_Styles.AC_Width=200,ATE_Styles.AC_TimelineHeight=60,ATE_Styles.AC_TimelineSegmentWidth=160,ATE_Styles.AC_TimelineSubSegmentHeight=6,ATE_Styles.AC_TimelineSubSegmentLimitsHeight=20,ATE_Styles.AC_TimelineSubSegment_Color="#f9f9f9",ATE_Styles.AC_TimelineSubSegment_TextStyle="bold 9px Arial",ATE_Styles.AC_TimelineLayerHeight=30,ATE_Styles.Timeline={OffsetX:22,OffsetY:0},ATE_Styles.Playback={DefaultTime:60,GUI_Width:52,GUI_Height:15,GUI_TextStyle:"bold 12px Arial",GUI_TextColor:"white",GUI_BackgroundColor:"red",GUI_LineColor:"#FF000066",GUI_TextTimeOffset:{X:2,Y:-4}},ATE_Styles.Scrollbar={HorizontalSize:14,VerticalSize:30},ATE_Util.GetDigitsByValue=function(e,t){for(var i=String(e),n=t-i.length,a=0;a<n;a++)i="0"+i;return i},ATE_Util.FormatTime=function(e,t,i){t=t<=1?2:t;var n=e/1e3/60,a=Math.floor(n),s=n-a,r=0,o="",l=void 0!==i&&i;if(2!==t||l){var c=Math.pow(10,t-2);r=60*s,o=Math.floor(100*(r-Math.floor(r)*c)),r=Math.floor(60*s)}else r=Math.floor(60*s);return ATE_Util.GetDigitsByValue(a,a>9?1:2)+":"+ATE_Util.GetDigitsByValue(r,2)+(l?"."+ATE_Util.GetDigitsByValue(o,2):"")},ATE_Util.FormatTimeAsSeconds=function(e){var t=e/1e3,i="";return i=Math.floor(100*(t-Math.floor(t))),t=Math.floor(t),ATE_Util.GetDigitsByValue(t,2)+"."+ATE_Util.GetDigitsByValue(i,2)},ATE_Util.HitTestCenterByPoint=function(e,t,i,n,a,s){var r=.5*i,o=.5*n;return e-r<a&&e+r>a&&t-o<s&&t+o>s},ATE_Util.HitTestByPoint=function(e,t,i,n,a,s){return e<a&&e+i>a&&t<s&&t+n>s},ATE_Engine.EPSILON=.001,ATE_Engine.GetLayerByPosition=function(e,t,i){var n=e.GetLayers(),a={};a.LayerIndex=-1,a.LayerOnFocus=void 0;for(var s=ATE_Styles.Timeline.OffsetX,r=ATE_Styles.AC_TimelineHeight+ATE_Styles.Timeline.OffsetY,o=ATE_Styles.AC_TimelineLayerHeight,l=e.GetGUI_RealSegmentWidth()*e.GetAnimationSeconds(),c=o,u=0;u<n.length;u++){var T=s,y=u*o+r;if(ATE_Util.HitTestByPoint(T,y,l,c,t,i)){a.LayerIndex=u,a.LayerOnFocus=n[u];break}}return a},ATE_Engine.GetKeyframeByPosition=function(e,t,i){var n=e.GetLayers(),a={};a.LayerOnFocus=void 0,a.KeyframeOnFocus=void 0;for(var s=0;s<n.length;s++){var r=n[s].GetKeyframeByPosition(t,i);if(r){a.LayerOnFocus=n[s],a.KeyframeOnFocus=r;break}}return a},ATE_Engine.GetSegment=function(e,t,i){var n=e.GetAnimationSeconds(),a=e.GetGUI_RealSegmentWidth(),s=e.GetGUI_RealSubSegmentWidth(),r=ATE_Styles.Timeline.OffsetX+0*a-s-ATE_Styles.Playback.GUI_Width/4+1+.5*ATE_Styles.Playback.GUI_Width+1,o=t+(s=e.GetGUI_RealSubSegmentWidth())/2-r,l=(e.GetGUI_RealSegmentWidth(),n*ATE_Styles.Default_SubSegments),c=Math.floor(o/s);return c=c<0?0:c,c=c>l?l:c},ATE_Engine.SetStylesInput_Time=function(e,t){e.css("text-align","center"),e.css("font-size","12px"),e.css("padding","1px"),e.css("width","36px"),e.css("margin","5px 0px 0px"),e.css("outline","none"),e.css("border-width","0px 0px 1px"),e.css("border-top-style","initial"),e.css("border-right-style","initial"),e.css("border-bottom-style","dotted"),e.css("border-left-style","initial"),e.css("border-top-color","initial"),e.css("border-right-color","initial"),e.css("border-bottom-color","rgb(184, 184, 184)"),e.css("border-left-color","initial"),e.css("border-image","initial"),e.css("background","none"),e.css("color","rgb(184, 184, 184)"),void 0!==t&&e.attr("disabled",t)},ATE_Layer.DataTypes={Numeric:1},ATE_Layer.TweenType={None:0,EaseLinear:1,EaseInQuad:2,EaseOutQuad:3,EaseInOutQuad:4,EaseInCubic:5,EaseOutCubic:6,EaseInOutCubic:7,EaseInSine:8,EaseOutSine:9,EaseInOutSine:10,EaseInExpo:11,EaseOutExpo:12,EaseInOutExpo:13,EaseInElastic:14,EaseOutElastic:15,EaseInOutElastic:16},ATE_Layer.EditControls={None:0,Value_Editable:1,Keyframe:2,Tween:3},ATE_Layer.SetLabelCSS_LayerName=function(e){e.css("height",ATE_Styles.AC_TimelineLayerHeight),e.css("font-size","13px"),e.css("color",ATE_Styles.AC_TimelineSubSegment_Color),e.css("font-family","arial"),e.css("margin-left","4px"),e.css("white-space","nowrap"),e.css("overflow","hidden"),e.css("text-overflow","ellipsis"),e.css("max-width","90px"),e.css("padding-top","8px"),e.css("max-height","20px")},ATE_Layer.SetLabelCSS_LayerValue=function(e){e.css("font-size","11px"),e.css("font-family","arial"),e.css("margin-right","2px"),e.css("width","40px"),e.css("float","right"),e.attr("disabled",!0)},ATE_Layer.CreateTweenSelect=function(e){var t="";t+="<select style='display:none;margin-right:2px;float:left;width:55px'>";for(var i in e)t+="   <option value='"+e[i]+"'>"+i+"</option>";return t+="</select>",$(t)},ATE_Layer.CreateKeyframeAddButton=function(){var e="";return e+="<img src='"+ATE_Resources.Diamond.Path+"' width='"+ATE_Resources.Diamond.TimelineWidth+"' height='"+ATE_Resources.Diamond.TimelineHeight+"' style='display:none;margin-right:2px;float:right;margin-top: 5px;'/>",$(e)},ATE_Layer.CreateHR=function(){var e=$("<hr />");return e.css("border-color",ATE_Styles.CStroke_Color),e.css("border-width","0.5px"),e.css("margin","0"),e.css("padding","0"),e.css("-webkit-margin-before","0"),e.css("-webkit-margin-before","0"),e.css("-webkit-margin-start","0"),e.css("-webkit-margin-end","0"),e},Easing.Equations={easeLinear:function(e,t,i,n){return i*e/n+t},easeInQuad:function(e,t,i,n){return i*(e/=n)*e+t},easeOutQuad:function(e,t,i,n){return-i*(e/=n)*(e-2)+t},easeInOutQuad:function(e,t,i,n){return(e/=n/2)<1?i/2*e*e+t:-i/2*(--e*(e-2)-1)+t},easeInCubic:function(e,t,i,n){return i*(e/=n)*e*e+t},easeOutCubic:function(e,t,i,n){return i*((e=e/n-1)*e*e+1)+t},easeInOutCubic:function(e,t,i,n){return(e/=n/2)<1?i/2*e*e*e+t:i/2*((e-=2)*e*e+2)+t},easeInQuart:function(e,t,i,n){return i*(e/=n)*e*e*e+t},easeOutQuart:function(e,t,i,n){return-i*((e=e/n-1)*e*e*e-1)+t},easeInOutQuart:function(e,t,i,n){return(e/=n/2)<1?i/2*e*e*e*e+t:-i/2*((e-=2)*e*e*e-2)+t},easeInQuint:function(e,t,i,n){return i*(e/=n)*e*e*e*e+t},easeOutQuint:function(e,t,i,n){return i*((e=e/n-1)*e*e*e*e+1)+t},easeInOutQuint:function(e,t,i,n){return(e/=n/2)<1?i/2*e*e*e*e*e+t:i/2*((e-=2)*e*e*e*e+2)+t},easeInSine:function(e,t,i,n){return-i*Math.cos(e/n*(Math.PI/2))+i+t},easeOutSine:function(e,t,i,n){return i*Math.sin(e/n*(Math.PI/2))+t},easeInOutSine:function(e,t,i,n){return-i/2*(Math.cos(Math.PI*e/n)-1)+t},easeInExpo:function(e,t,i,n){return 0==e?t:i*Math.pow(2,10*(e/n-1))+t},easeOutExpo:function(e,t,i,n){return e==n?t+i:i*(1-Math.pow(2,-10*e/n))+t},easeInOutExpo:function(e,t,i,n){return 0==e?t:e==n?t+i:(e/=n/2)<1?i/2*Math.pow(2,10*(e-1))+t:i/2*(2-Math.pow(2,-10*--e))+t},easeInCirc:function(e,t,i,n){return-i*(Math.sqrt(1-(e/=n)*e)-1)+t},easeOutCirc:function(e,t,i,n){return i*Math.sqrt(1-(e=e/n-1)*e)+t},easeInOutCirc:function(e,t,i,n){return(e/=n/2)<1?-i/2*(Math.sqrt(1-e*e)-1)+t:i/2*(Math.sqrt(1-(e-=2)*e)+1)+t},easeInElastic:function(e,t,i,n){var a=1.70158,s=0,r=i;if(0==e)return t;if(1==(e/=n))return t+i;if(s||(s=.3*n),r<Math.abs(i)){r=i;a=s/4}else a=s/(2*Math.PI)*Math.asin(i/r);return-r*Math.pow(2,10*(e-=1))*Math.sin((e*n-a)*(2*Math.PI)/s)+t},easeOutElastic:function(e,t,i,n){var a=1.70158,s=0,r=i;if(0==e)return t;if(1==(e/=n))return t+i;if(s||(s=.3*n),r<Math.abs(i)){r=i;a=s/4}else a=s/(2*Math.PI)*Math.asin(i/r);return r*Math.pow(2,-10*e)*Math.sin((e*n-a)*(2*Math.PI)/s)+i+t},easeInOutElastic:function(e,t,i,n){var a=1.70158,s=0,r=i;if(0==e)return t;if(2==(e/=n/2))return t+i;if(s||(s=n*(.3*1.5)),r<Math.abs(i)){r=i;a=s/4}else a=s/(2*Math.PI)*Math.asin(i/r);return e<1?r*Math.pow(2,10*(e-=1))*Math.sin((e*n-a)*(2*Math.PI)/s)*-.5+t:r*Math.pow(2,-10*(e-=1))*Math.sin((e*n-a)*(2*Math.PI)/s)*.5+i+t},easeOutBounce:function(e,t,i,n){return(e/=n)<1/2.75?i*(7.5625*e*e)+t:e<2/2.75?i*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?i*(7.5625*(e-=2.25/2.75)*e+.9375)+t:i*(7.5625*(e-=2.625/2.75)*e+.984375)+t}};